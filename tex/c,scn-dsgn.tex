% optimized scan design

\section{Introduction}
\label{s,scn-dsgn,intro}

Fast, accurate \emph{relaxometry}, 
or quantification
of spin-lattice and spin-spin relaxation parameters $\To$ and $\Tt$ 
has been of longstanding interest in MRI. 
Many researchers have suggested 
that $\To, \Tt$ ``maps''
(\ie, estimated parameter images)
may serve as biomarkers 
for monitoring the progression 
of various disorders \cite{cheng:12:pma}. 
Neurological applications include: 
lesion classification in multiple sclerosis 
\cite{larsson:88:ivd}; 
tumor characterization 
\cite{kurki:96:tco, englund:86:rti}; 
and symptom onset prediction in stroke 
\cite{siemonsen:09:qtv, dewitt:87:nnc}. 
In addition, 
$\To, \Tt$ have shown promise 
for detecting hip and knee cartilage degeneration 
\cite{matzat:13:qmt, mosher:04:cmt} 
and for assessing cardiac dysfunction 
due to iron overload \cite{guo:09:mtq} 
or edema \cite{giri:09:tqf}. 
Motivated by this broad interest 
in $\To, \Tt$ mapping, 
this chapter describes a systematic method 
to guide QMRI scan design.

Classical pulse sequences 
such as inversion/saturation recovery (IR/SR) 
or (single) spin echo (SE) 
yield relatively simple methods 
for $\To$ or $\Tt$ estimation, respectively; 
however, these methods require several scans, 
each with long repetition time $\TR$, 
leading to undesirably long acquisitions. 
Numerous modifications 
such as the Look-Locker method \cite{look:70:tsi}, 
multi-SE trains \cite{carr:54:eod}, 
or fast $\mathbf{k}$-space trajectories 
\cite{stehling:91:epi, ahn:86:hss, meyer:92:fsc} 
have been proposed to accelerate $\To$ 
\cite{kay:91:pia, gowland:92:faa, messroghli:04:mll, stehling:90:ire} 
and $\Tt$ 
\cite{bonny:96:tml, kumar:12:bau, beneliezer:15:raa, nguyen:12:ttd} 
relaxometry 
with these classical sequences.
These techniques are more sensitive 
to model non-idealities 
\cite{majumdar:86:eit-1, majumdar:86:eit-2, farzaneh:90:aot}, 
and are still speed-limited 
by the long $T_\mathrm{R}$ required 
for (near)-complete $\To$ recovery.

Steady-state (SS) pulse sequences 
\cite{hinshaw:76:ifb, scheffler:99:apd} 
permit short $T_\mathrm{R}$, 
and are thus inherently much faster 
than classical counterparts.
SS techniques are well-suited for relaxometry 
because the signals produced are highly sensitive 
to $\To$ and $\Tt$ variation. 
However, short $T_\mathrm{R}$ times also cause SS signals 
to be complex functions 
of both desired and undesired (\emph{nuisance}) parameters, 
complicating quantification. 
Furthermore, some such methods 
\cite{deoni:03:rct, chang:08:lls} 
still require scan repetition, 
though individual scans are now considerably shorter. 
Despite these difficulties, 
the potential for rapid scanning 
with high $\To, \Tt$ sensitivity 
has motivated numerous SS relaxometry studies 
\cite{fram:87:rco, deoni:03:rct, chang:08:lls, wang:12:srt, deoni:04:rte, deoni:09:trt, welsch:09:reo, heule:14:reo, stocker:14:mpq, heule:14:tes-mrm}.

The dual-echo steady-state (DESS) sequence \cite{bruder:88:ans} 
was recently proposed as a promising SS imaging technique 
for $\Tt$ estimation \cite{welsch:09:reo}. 
Because it produces two distinct signals per excitation, 
the DESS sequence can reduce scan repetition requirements 
by recording twice as much data per scan. 
As with other SS methods, 
the resulting signals 
\cite{gyngell:89:tss, hanicke:03:aas} 
are complicated functions 
of $\To$, $\Tt$, and other parameters
(see Section~\ref{sss,bkgrd,mri,ss,dess}
for derivations). 
Prior works have isolated $\Tt$ dependencies 
using either algebraic manipulations 
of the first- and second-echo signals 
\cite{welsch:09:reo, heule:14:reo} 
or separate scans to first estimate nuisance parameters 
\cite{nataraj:14:mbe}. 
Although DESS concurrently encodes rich $\To$ and $\Tt$ information, 
these methods have shied away from using DESS 
for $\To$ estimation, 
either through bias-inducing approximations, 
or noise-propagating sequential estimation, 
respectively. 

Whether it be with DESS, other sequences, or even combinations thereof, 
it is generally unclear how to best assemble a \emph{scan profile} 
(\emph{i.e.}, a collection of scans) 
for a fixed amount of scan time. 
Furthermore, for a given scan profile, 
it is typically not obvious how 
to best select acquisition parameters 
(\emph{e.g.}, flip angles, repetition times, etc.) 
for relaxometry. 
In this and subsequent chapters, 
the term \emph{scan design} refers 
to the related problems 
of scan profile selection 
and acquisition parameter optimization.

Historically, scan design for relaxometry
has mainly been explored 
using figures of merit related to estimator precision. 
In particular, several studies have used the \Cramer-Rao Bound (CRB), 
a statistical tool that bounds the minimum variance of an unbiased estimator.
Earlier works have used the CRB and variations 
to select inversion times for recovery experiments 
\cite{weiss:80:tco, zhang:98:dos}, 
flip angles for spoiled gradient-recalled echo (SPGR) sequences \cite{wang:87:otp}, 
and echo times for SE experiments \cite{jones:96:oss}. 
More recent studies have considered additional scan design challenges, 
including scan time constraints \cite{imran:99:tpm}, 
multiple latent parameters \cite{deoni:04:doo}, 
multiple scan parameter types \cite{fleysher:07:otp}, 
and latent parameter spatial variation \cite{akcakaya:15:ots, lewis:16:ddo}. 

The aforementioned studies consider scan parameter optimization 
for profiles consisting of \emph{only one} pulse sequence.
In contrast, this chapter introduces a general framework 
for robust, application-specific scan design 
for parameter estimation from \emph{combinations} of pulse sequences.
The framework first finds multiple sets of scan parameters 
that achieve precise estimation 
within a tight, \emph{application-specific} range 
of object parameters (\emph{e.g.}, $\To, \Tt$, etc.).
The framework then chooses the one scan parameter set 
most \emph{robust} to estimator precision degradation 
over a broader range of object parameters.
As a detailed example, 
we optimize three combinations of SPGR and DESS sequences 
for $\To, \Tt$ mapping. 
For a fixed total scan time, 
we find that well-chosen DESS scans alone 
can be used to estimate both $\To$ and $\Tt$ 
with precision and robustness comparable 
to combinations of SPGR and DESS. 
This example illustrates that, 
with careful scan profile design, 
well-established pulse sequences 
can find use in new estimation problems.

This chapter is organized as follows. 
Section~\ref{s,scn-dsgn,crb} describes 
a CRB-inspired min-max optimization problem 
for robust, application-specific scan optimization. 
Section~\ref{s,scn-dsgn,opt} optimizes 
three practical DESS/SPGR combinations 
to show that, 
even in the presence of radiofrequency (RF) field inhomogeneity, 
DESS is a promising option for $\To, \Tt$ relaxometry.  
Section~\ref{s,scn-dsgn,exp} describes 
simulation, phantom, and \invivo experiments 
and discusses corresponding results.
Section~\ref{s,scn-dsgn,disc} discusses practical challenges 
and suggests future directions.
Section~\ref{s,scn-dsgn,conc} summarizes key contributions.

\section{A CRB-Inspired Scan Selection Method}
\label{s,scn-dsgn,crb}

\subsection{The CRB and its Relevance to QMRI}
\label{ss,scn-dsgn,crb,sig}

Recall from Section~\ref{ss,relax,meth,prof}
that after image reconstruction,
we can model the single-voxel MR image domain data
associated with a particular scan profile as 
\begin{align}
	\bmy = \bms\paren{\bmx; \bmnu, \bmP} + \bmeps,
	\label{eq:scn-dsgn,mod-vec-abbrev}
\end{align}
where signal model
$\bms := \brac{s_1, \dots, s_D}\tpose
: \complexes{L} \times \complexes{K} \times \reals{A \times D} \mapsto \complexes{D}$
relates latent $\bmx \in \complexes{L}$,
known $\bmnu \in \complexes{K}$,
and acquisition $\bmP \in \reals{A \times D}$ parameters
to noisy scan profile image data $\bmy \in \complexes{D}$, 
barring noise $\bmeps \in \complexes{D}$.
Assuming (as in Section~\ref{ss,relax,meth,prof})
complex Gaussian noise $\bmeps \sim \cgauss{\mathbf{0}}{\bmSig}$,
the likelihood function \eqref{eq:relax,lf-vec} is
(to within constants independent of $\bmx$)
\begin{align}
	\Lf{\bmx|\bmy} \propto
		\expa{-\norm{\bmy - \bms\paren{\bmx; \bmnu, \bmP}}^2_{\bmSig^{-1}}}.
	\label{eq:scn-dsgn,lf-vec}
\end{align}
Under suitable regularity conditions
\footnote{In particular,
$\bms$ must be analytic in complex components
of $\bmx$.},
the Fisher information matrix 
$\Fisher{\bmx; \bmnu, \bmP} \in \complexes{L \times L}$
\cite{fisher:1925:tos}
characterizes the imprecision 
of unbiased estimates 
of $\bmx$ from $\bmy$, 
given $\bmnu$ and $\bmP$:
\begin{align}
	\Fisher{\bmx; \bmnu, \bmP} 
		&:= 
		\expect{\bmy}{\paren{\grada{\bmx} \log{\Lf{\bmx|\bmy}}}\ctpose
		\grada{\bmx} \log{\Lf{\bmx|\bmy}}} 
		\nonumber \\
		&= 
		\paren{\grada{\bmx} \bms\paren{\bmx; \bmnu, \bmP}}\ctpose
		\bmSig^{-1} \grada{\bmx} \bms\paren{\bmx; \bmnu, \bmP}
		\label{eq:scn-dsgn,fisher},
\end{align}
where $\expect{\bmy}{\cdot}$ denotes element-wise expectation
with respect to $\bmy$.
In particular,
the matrix CRB \cite{cramer:46} ensures
that any unbiased estimator $\est{\bmx}$ satisfies
\begin{align}
	\cov{\est{\bmx}; \bmnu, \bmP} \succeq
		\bmF^{-1}\paren{\bmx; \bmnu, \bmP},
		\label{eq:scn-dsgn,crb}
\end{align}
where for arbitrary, equally-sized $\Const{1}$ and $\Const{2}$,
matrix inequality $\Const{1} \succeq \Const{2}$ 
means $\Const{1}-\Const{2}$ is positive semi-definite.
In the following,
we design an optimization problem 
based on the CRB
to guide QMRI scan design 
for relaxometry.

\subsection{Min-max Optimization Problem for Scan Design}
\label{ss,scn-dsgn,crb,minmax}

Following \cite{chernoff:53:lod}, 
we focus on minimizing a weighted average 
of the variances 
in each of the $L$ latent object parameter estimates. 
A reasonable objective function 
for overall estimator precision 
is therefore given by
\begin{align}
	\costa{\bmx; \bmnu, \bmP} =
		\trace{\bmW \bmF^{-1}\paren{\bmx; \bmnu, \bmP} \bmW\tpose}, 
		\label{eq:scn-dsgn,cost}
\end{align}
where $\bmW \in \reals{L \times L}$ 
is a diagonal, application-specific  matrix of weights, 
preselected to control the relative importance 
of precisely estimating the $L$ latent object parameters. 
For scan design, 
we would like to minimize \eqref{eq:scn-dsgn,cost} 
with respect to scan parameters $\bmP$.
 
The CRB depends not only on $\bmP$ 
but also on the spatially varying object parameters 
$\bmx$ and $\bmnu$. 
Thus, one cannot perform scan design 
by ``simply'' minimizing $\cost$ 
with respect to scan parameters $\bmP$. 
Instead, we pose a 
\emph{min-max} optimization problem 
for scan design: 
we seek candidate scan parameters $\bmPc$ 
over a search space $\setP$ 
that \emph{minimize} the worst-case 
(\emph{i.e.}, \emph{maximum}) 
cost $\costwt$, 
as viewed over ``tight'' object parameter ranges 
$\setXt$ and $\setNt$:
\begin{align}
	\breve{\bmP} &\in 
		\set{\argmin{\bmP \in \setP} \costawt{\bmP}}, \where 
		\label{eq:scn-dsgn,P-cand} \\
	\costawt{\bmP} &:=
		\max_{\substack{\bmx \in \setXt \\ \bmnu \in \setNt}}
		\costa{\bmx; \bmnu, \bmP}.
		\label{eq:scn-dsgn,cost-tight}
\end{align}
Here, 
we select \emph{latent} parameter set $\setXt$ 
based on the application 
and \emph{known} parameter set $\setNt$ 
based on the spatial variation typically observed 
in the known parameters $\bmnu$. 
Min-max approach \eqref{eq:scn-dsgn,P-star} 
should ensure good estimation precision 
over a range of parameter values.

Since $\Psi$ is in general non-convex 
with respect to $\bmP$, 
it may have multiple global minimizers 
as well as other scan parameters 
that are nearly global minimizers. 
To improve robustness 
to object parameter variations, 
we form an expanded set of candidate scan parameters 
by also including scan parameters 
that yield costs to within a tolerance $\delta \ll 1$ 
of the optimum. 
Mathematically, 
we define this expanded set 
of candidate scan parameter combinations 
(for a given scan profile) as 
\begin{align}
	\setPc &:= 
		\set{\bmP : \costawt{\bmP} - \costawt{\bmPc} \le \delta \costawt{\bmPc}}.
		\label{eq:scn-dsgn,set}
\end{align}
To select amongst these candidate scan parameters, 
we employ a robustness criterion: 
we select the single scan parameter $\bmPs$ 
that degrades the least 
when the worst-case cost is viewed 
over widened object parameter sets 
$\setXb \supseteq \setXt$ and $\setNb \supseteq \setNt$:
\begin{align}
	\bmPs &= 
		\argmin{\bmP \in \setPc} \costawb{\bmP}, \where
		\label{eq:scn-dsgn,P-star} \\
	\costawb{\bmP} &:=
		\max_{\substack{\bmx \in \setXb \\ \bmnu \in \setNb}}
		\costa{\bmx; \bmnu, \bmP}.
		\label{eq:scn-dsgn,cost-broad}
\end{align}
To compare different scan profiles, 
we select corresponding search spaces $\setP$ 
to satisfy acquisition constraints 
(\emph{e.g.}, total scan time), 
but otherwise hold optimization parameters 
$\bmW$, $\delta$, $\setXt$, $\setXb$, $\setNt$, $\setNb$ fixed.
Since $\Psi$ is data-independent, 
we can solve \eqref{eq:P,star} and \eqref{eq:P,hat} offline 
for each scan profile. 
The result of each profile's min-max optimization process \eqref{eq:P,hat} 
is a corresponding optimized scan parameter matrix $\bmPs$ 
that is suitable for the range 
of latent $\bmx$ and known $\bmnu$ object parameters specified 
in $\setXt$ and $\setNt$, 
and is robust to variations in those parameters 
over broader sets $\setXb$ and $\setNb$, 
respectively.

\section{Optimizing SS Sequences for Relaxometry in the Brain}
\label{s,scn-dsgn,opt}

This section applies the methods 
of Section~\ref{ss,scn-dsgn,crb,minmax} 
to the problem of scan design 
for joint $\To,\Tt$ estimation 
from combinations of SS sequences. 
Section~\ref{ss,scn-dsgn,opt,design} details 
how we use optimization problems
\eqref{eq:scn-dsgn,P-cand} and \eqref{eq:scn-dsgn,P-star} 
to tailor three SPGR and DESS scan combinations
for precise $\To,\Tt$ estimation 
in white matter (WM) and grey matter (GM) regions 
of the brain. 
Section~\ref{ss,scn-dsgn,opt,compare} compares the predicted performance 
of the three optimized scan profiles.

\subsection{Scan Design Details}
\label{ss,scn-dsgn,opt,design}



\subsection{Scan Profile Comparisons}
\label{ss,scn-dsgn,opt,compare}
